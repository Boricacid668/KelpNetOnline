branches:
  only:
    - master

skip_tags: true

image: Visual Studio 2017

configuration: Release

before_build:
    - nuget restore KelpNet.sln

build: 
  parallel: true
  project: KelpNet.sln
  verbosity: normal

before_test:
    - "SET PATH=C:\\Python37-x64;C:\\Python37-x64\\Scripts;%PATH%"
    - pip install chainer

after_test:
    - .\packages\OpenCover.4.6.519\tools\OpenCover.Console.exe -register:user -target:"C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\Common7\IDE\CommonExtensions\Microsoft\TestWindow\vstest.console.exe" -targetargs:"KelpNetTests.dll /platform:x64" -targetdir:".\KelpNetTests\bin\Release" -excludebyattribute:*.ExcludeFromCodeCoverage* -hideskipped:All -output:Cover_result.xml
    - pip install codecov
    - codecov -f "Cover_result.xml"
